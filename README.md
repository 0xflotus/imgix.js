# imgix.js

## Resources

* [Srcset and sizes by Eric Portis](https://ericportis.com/posts/2014/srcset-sizes/). A seminal article on `srcset`, `sizes`, and `picture`. Explains why they're necessary, and how they work together.
* [Using imgix with `<picture>`](https://docs.imgix.com/tutorials/using-imgix-picture-element). Discusses the differences between art direction and resolution switching, and provides examples of how to accomplish art direction with imgix.
* [Responsive Images with `srcset` and imgix](https://docs.imgix.com/tutorials/responsive-images-srcset-imgix). A look into how imgix can work with `srcset` and `sizes` to serve the right image.


## Installation & Usage

There are several ways to install imgix.js. The appropriate method depends on your project.

1. `npm install --save imgix.js`
2. `bower install --save imgix.js`
3. [Download the latest release of imgix.js](https://github.com/imgix/imgix.js/releases/latest), and extract `dist/imgix.js` or `dist/imgix.min.js` to your project.

After you've included imgix.js on your page, you just have to run it (you'll probably want to put this at the bottom of your page, just before the `</body>` tag):

``` html
<script src="imgix.js"></script>
<script>
  imgix.init();
</script>
```

Now that everything's set, you can start creating responsive images. There are a few ways to do this. First of all, you can use an `img` tag with the `ix-src` attribute:

``` html
<img ix-src="https://assets.imgix.net/unsplash/hotairballoon.jpg?w=300&amp;h=500&amp;fit=crop&amp;crop=right" alt="A hot air balloon on a sunny day">
```

This will generate HTML something like the following:

``` html
<img
  ix-src="https://assets.imgix.net/unsplash/hotairballoon.jpg?w=300&amp;h=500&amp;fit=crop&amp;crop=right"
  alt="A hot air balloon on a sunny day"
  sizes="100vw"
  srcset="
    https://assets.imgix.net/unsplash/hotairballoon.jpg?w=100&amp;h=167&amp;fit=crop&amp;crop=right 100w,
    https://assets.imgix.net/unsplash/hotairballoon.jpg?w=200&amp;h=333&amp;fit=crop&amp;crop=right 200w,
    â€¦
    https://assets.imgix.net/unsplash/hotairballoon.jpg?w=2560&amp;h=4267&amp;fit=crop&amp;crop=right 2560w
  "
  src="https://assets.imgix.net/unsplash/hotairballoon.jpg?w=300&amp;h=500&amp;fit=crop&amp;crop=right"
  ix-initialized="ix-initialized"
>
```

Since imgix can generate as many derivitive resolutions as needed, imgix.js calculates them programmatically, using the dimensions you specify (note that the `w` and `h` params scale appropriately to maintain the correct aspect ratio). All of this information has been placed into the `srcset` and `sizes` attributes. Because of this, imgix.js no longer needs to watch or change the `img` tag, as all responsiveness will be handled automatically by the browser.

If you set the `imgix.config.host` value to your imgix hostname, you can use `ix-path` and `ix-params` to define images, instead of having to manually type URLs out in `imgix-src`. This has several advantages:

1. `ix-params` automatically URL/Base64 encodes your specified params, as appropriate.
2. `ix-params` is a JSON string, which is easier to read than a URL, and can be generated by other tools if necessary.
3. Not having to re-type `https://my-source.imgix.net` helps keep your code DRY.

Here's an example of how to set that up:

``` html
<script src="imgix.js"></script>
<script>
  imgix.config.host = 'assets.imgix.net';
  imgix.init();
</script>
```

And here's how the previous example would be written out using `ix-path` and `ix-params` instead of `ix-src`:

``` html
<img ix-path="unsplash/hotairballoon.jpg" ix-params='{
  "w": 300,
  "h": 500,
  "fit": "crop",
  "crop": "right"
}' alt="A hot air balloon on a sunny day">
```

Regardless of which method you choose, the end result in-browser will be the same.


### Browser Compatibility Notes

* If you are using [Base64 variant params](https://docs.imgix.com/apis/url#base64-variants) and need IE <= 9 support, we recommend using a polyfill for `atob`/`btoa`, such as [Base64.js](https://github.com/davidchambers/Base64.js).
* By default, browsers that don't support [`srcset`](http://caniuse.com/#feat=srcset), [`sizes`](http://caniuse.com/#feat=srcset), or [`picture`](http://caniuse.com/#feat=picture) will gracefully fall back to the default `img` `src` when appropriate. If you want these browsers to display responsive images in these cases instead, we recommend using [Picturefill](https://github.com/scottjehl/picturefill).


## Development

1. `npm install`
2. Write code
3. `npm run build && npm test`
4. Repeat #2 and #3 as necessary
